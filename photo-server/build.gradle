plugins {
    id 'photoOrganizer.java-application-conventions'
}


group = 'org.stapledon'
version = '0.0.1-SNAPSHOT'
sourceCompatibility = "${java_version}"


dependencies {
	implementation 'org.springframework.boot:spring-boot-starter-web'
	implementation 'org.springframework.boot:spring-boot-starter-actuator'
	implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
	implementation 'org.springframework.boot:spring-boot-starter-security'
	implementation 'org.springframework.boot:spring-boot-starter-validation'

	implementation 'io.jsonwebtoken:jjwt:0.9.1'
	implementation 'org.liquibase:liquibase-core:4.22.0'

	implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.1.0'
	implementation 'io.springfox:springfox-swagger2:3.0.0'
	implementation 'io.swagger.core.v3:swagger-annotations:2.2.10'

	implementation 'org.postgresql:postgresql:42.6.0'
}

springBoot {
	buildInfo()
}

tasks.register("updateApiDocs") {
	copy {
		from 'build/openapi.json'
		into "../docs"
	}
}

tasks.named("build") {
	finalizedBy("updateApiDocs")
}


bootRun {
	environment("SPRING_DATASOURCE_URL", "jdbc:tc:postgresql:13.9://localhost/testdb?TC_TMPFS=/var/lib/postgresql/data:rw")
	environment("SPRING_DATASOURCE_DRIVERCLASSNAME", "org.testcontainers.jdbc.ContainerDatabaseDriver")
}